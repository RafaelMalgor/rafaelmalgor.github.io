import{f as e}from"./vendor.519c7c38.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const a=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,c)=>{const d=new URL(e,a);if(self[t].moduleMap[d])return n(self[t].moduleMap[d]);const s=new Blob([`import * as m from '${d}';`,`${t}.moduleMap['${d}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){c(new Error(`Failed to import: ${e}`)),o(i)},onload(){n(self[t].moduleMap[d]),o(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/assets/");const t={apiKey:"AIzaSyDhMFVUourvyLmRsVUEA7yNi3klUXE0wp8",authDomain:"webrtcvideocall-cf42b.firebaseapp.com",projectId:"webrtcvideocall-cf42b",storageBucket:"webrtcvideocall-cf42b.appspot.com",messagingSenderId:"621771754753",appId:"1:621771754753:web:8f2bfd9e1e25dfec905f00",measurementId:"G-DVEV03TV3T"};e.apps.length||e.initializeApp(t);const n=e.firestore(),a={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10};let o=null,c=null,d=null;const s=document.getElementById("webcamButton"),i=document.getElementById("webcamVideo"),l=document.getElementById("callinput"),r=document.getElementById("answerInput"),p=document.getElementById("answerButton"),m=document.getElementById("remoteVideo"),u=document.getElementById("video-content"),y=document.getElementById("hangbutton"),f=document.getElementById("actions"),w=document.getElementById("copybutton");let g=f.style.display,C=u.style.display,b=!1;async function I(){o=new RTCPeerConnection(a),c=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),d=new MediaStream,c.getTracks().forEach((e=>{o.addTrack(e,c)})),o.ontrack=e=>{e.streams[0].getTracks().forEach((e=>{d.addTrack(e)}))},i.srcObject=c,m.srcObject=d}u.style.display="none",w.onclick=()=>{l.select(),l.setSelectionRange(0,99999),document.execCommand("copy")},s.onclick=async()=>{u.style.display=C,f.style.display="none",await I(),s.textContent="Stop Video Call",await async function(){const e=n.collection("calls").doc(),t=e.collection("offerCandidates"),a=e.collection("answerCandidates");l.value=e.id,o.onicecandidate=e=>{e.candidate&&t.add(e.candidate.toJSON())};const c=await o.createOffer();await o.setLocalDescription(c);const d={sdp:c.sdp,type:c.type};await e.set({offer:d}),e.onSnapshot((e=>{const t=e.data();if(!o.currentRemoteDescription&&(null==t?void 0:t.answer)){const e=new RTCSessionDescription(t.answer);o.setRemoteDescription(e)}})),a.onSnapshot((e=>{e.docChanges().forEach((e=>{if("added"===e.type){const t=new RTCIceCandidate(e.doc.data());o.addIceCandidate(t)}}))}))}()},y.onclick=()=>{o.close(),i.srcObject=null,m.srcObject=null,s.textContent="Start Video Call",u.style.display="none",f.style.display=g},r.onchange=()=>{b=r.value.length>0},p.onclick=async()=>{if(!b)return;await I();const e=r.value,t=n.collection("calls").doc(e),a=t.collection("answerCandidates"),c=t.collection("offerCandidates");o.onicecandidate=e=>{e.candidate&&a.add(e.candidate.toJSON())};const d=(await t.get()).data().offer;await o.setRemoteDescription(new RTCSessionDescription(d));const s=await o.createAnswer();await o.setLocalDescription(s);const i={type:s.type,sdp:s.sdp};await t.update({answer:i}),c.onSnapshot((e=>{e.docChanges().forEach((e=>{if(console.log(e),"added"===e.type){let t=e.doc.data();o.addIceCandidate(new RTCIceCandidate(t))}}))})),u.style.display=C,f.style.display="none"};
